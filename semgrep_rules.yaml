rules:
  - id: flask-sql-injection
    languages: [python]
    message: "ðŸš¨ InjeÃ§Ã£o de SQL detectada! Use queries parametrizadas."
    severity: ERROR
    patterns:
      - pattern: |
          cursor.execute("SELECT * FROM users WHERE username = " + request.args["username"])
      - pattern: |
          cursor.execute(f"SELECT * FROM users WHERE username = '{request.args['username']}'")
      - pattern: |
          cursor.execute("SELECT * FROM users WHERE username = '{}'".format(request.args["username"]))

  - id: flask-xss
    languages: [python]
    message: "ðŸš¨ XSS detectado! Sanitizar entrada do usuÃ¡rio antes de exibir."
    severity: ERROR
    patterns:
      - pattern: |
          render_template_string(request.args['input'])
      - pattern: |
          return f"<h1>{request.args['input']}</h1>"

